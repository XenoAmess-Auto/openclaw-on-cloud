<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¶ˆæ¯æ ·å¼æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f3f4f6;
      padding: 20px;
    }
    
    .chat-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 20px;
    }
    
    /* æ¨¡æ‹Ÿæ¶ˆæ¯å¸ƒå±€ */
    .message {
      display: flex;
      gap: 0.75rem;
      max-width: 80%;
      margin-bottom: 1rem;
    }
    
    .message-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #4f46e5;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }
    
    .message-body {
      background: #f3f4f6;
      padding: 0.75rem 1rem;
      border-radius: 12px;
      min-width: 0;
      flex: 1;
    }
    
    /* ä¿®å¤åçš„ message-content æ ·å¼ */
    .message-content {
      line-height: 1.5;
      word-break: break-word;
      overflow-wrap: break-word;
      max-width: 100%;
      min-width: 0;
    }
    
    /* ä»£ç å—æ ·å¼ - ä¸¥æ ¼é˜²æ­¢æº¢å‡º */
    .message-content pre {
      max-width: 100%;
      width: 100%;
      overflow-x: auto;
      white-space: pre-wrap !important;
      word-wrap: break-word !important;
      word-break: break-all !important;
      box-sizing: border-box;
      background: #1e1e2e;
      color: #cdd6f4;
      padding: 1rem;
      border-radius: 8px;
      margin: 0.5rem 0;
    }
    
    .message-content pre code {
      white-space: pre-wrap !important;
      word-wrap: break-word !important;
      word-break: break-all !important;
      display: block;
      max-width: 100%;
      background: transparent;
      padding: 0;
    }
    
    .message-content code {
      word-wrap: break-word;
      white-space: pre-wrap;
      word-break: break-all;
      max-width: 100%;
      background: rgba(0,0,0,0.05);
      padding: 0.2em 0.4em;
      border-radius: 3px;
      font-family: monospace;
    }
    
    /* ç¡®ä¿æ‰€æœ‰å­å…ƒç´ ä¸æº¢å‡º */
    .message-content * {
      max-width: 100%;
      box-sizing: border-box;
    }
    
    /* ç‰¹åˆ«å¤„ç†å¯èƒ½æº¢å‡ºçš„å…ƒç´  */
    .message-content p,
    .message-content div,
    .message-content span {
      max-width: 100%;
      word-break: break-word;
    }
    
    .message-content ul,
    .message-content ol {
      padding-left: 1.5rem;
      margin: 0.5rem 0;
    }
    
    .message-content li {
      margin: 0.25rem 0;
    }
    
    .message-content strong {
      font-weight: 600;
    }
    
    .test-title {
      font-size: 1.25rem;
      font-weight: bold;
      margin-bottom: 1rem;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="chat-container">
    <div class="test-title">æ¶ˆæ¯æ ·å¼æµ‹è¯• - æ£€æŸ¥æ˜¯å¦æº¢å‡º</div>
    
    <div class="message">
      <div class="message-avatar">AI</div>
      <div class="message-body">
        <div class="message-header" style="font-size: 0.875rem; color: #666; margin-bottom: 0.25rem;">
          <span style="font-weight: 500;">OpenClaw</span>
        </div>
        <div class="message-content">
          <p><strong>Tools used:</strong></p>
          <ul>
            <li><code>web_search</code>: æœç´¢ä¿¡æ¯</li>
          </ul>
          <pre><code class="language-bash">$ curl -s "wttr.in/Beijing?format=3"
Beijing: +15Â°C â˜€ï¸   ğŸŒ¡ï¸+15Â°C ğŸŒ¬ï¸â†—15km/h
This is a very long line that should not overflow the message bubble and should wrap properly within the container boundaries without extending beyond the left or right edges of the message bubble.</code></pre>
          <p>æŸ¥è¯¢ç»“æœï¼šæ‰¾åˆ°ç›¸å…³ä¿¡æ¯ã€‚</p>
        </div>
      </div>
    </div>
    
    <div class="message">
      <div class="message-avatar">AI</div>
      <div class="message-body">
        <div class="message-content">
          <p>è¿™æ˜¯ä¸€æ®µåŒ…å« <code>veryLongFunctionNameThatMightCauseOverflow()</code> çš„è¡Œå†…ä»£ç æµ‹è¯•ã€‚</p>
          <p><strong>ç²—ä½“æ–‡æœ¬</strong> å’Œ <em>æ–œä½“æ–‡æœ¬</em> åº”è¯¥æ­£å¸¸æ˜¾ç¤ºã€‚</p>
        </div>
      </div>
    </div>
    
    <div class="message">
      <div class="message-avatar">AI</div>
      <div class="message-body">
        <div class="message-content">
          <pre><code class="language-json">{"key": "value", "longKeyName": "this is a very long value that should wrap properly", "array": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]}</code></pre>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // æ£€æŸ¥æ˜¯å¦æœ‰æº¢å‡º
    function checkOverflow() {
      const messages = document.querySelectorAll('.message');
      let hasOverflow = false;
      
      messages.forEach((msg, index) => {
        const body = msg.querySelector('.message-body');
        const content = msg.querySelector('.message-content');
        
        if (body && content) {
          const bodyRect = body.getBoundingClientRect();
          const contentRect = content.getBoundingClientRect();
          const containerRect = document.querySelector('.chat-container').getBoundingClientRect();
          
          // æ£€æŸ¥æ˜¯å¦è¶…å‡ºå®¹å™¨
          if (contentRect.right > bodyRect.right || contentRect.left < bodyRect.left) {
            console.error(`æ¶ˆæ¯ ${index + 1} æº¢å‡ºï¼`);
            console.error(`  body: ${bodyRect.left} - ${bodyRect.right}`);
            console.error(`  content: ${contentRect.left} - ${contentRect.right}`);
            hasOverflow = true;
          } else {
            console.log(`æ¶ˆæ¯ ${index + 1} æ­£å¸¸`);
          }
        }
      });
      
      if (hasOverflow) {
        console.error('âŒ æ£€æµ‹åˆ°æº¢å‡ºï¼');
      } else {
        console.log('âœ… æ‰€æœ‰æ¶ˆæ¯éƒ½æ­£å¸¸ï¼Œæ²¡æœ‰æº¢å‡º');
      }
      
      return !hasOverflow;
    }
    
    // é¡µé¢åŠ è½½åæ£€æŸ¥
    window.onload = () => {
      setTimeout(checkOverflow, 100);
    };
  </script>
</body>
</html>
